{% extends 'navs.html' %}
{% load static %}


{% block main_content %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
<link rel="stylesheet" href="{% static 'css/match-block.css' %}">
<script defer src="{% static 'js/match-block.js' %}"></script>
<script defer src="{% static 'js/edit-profile.js' %}"></script>
<script defer src="{% static 'js/change-password.js' %}"></script>
<script defer src="{% static 'js/friends_add_remove.js' %}"></script>
<script defer src="{% static 'js/notifications.js' %}"></script>
<div class="main-content">
    <div class="main">
        <div class="side-profile">
            <div id="change-info1">
                <img class="profile-big" src="{{ user_view.picture.url }}" alt="User">
                <h3 class="description"> {{ user_view.username }} </h3>
            </div>
            <h3 class="description"> {{ user_view.status }} </h3>
            {% if is_own_profile %}
                <button class="edit" id="edit-profile-button" onclick="onEditButtonClick()">Edit Profile</button>
                <button class="save" id="save-profile-button" style="display:none;" onclick="onSaveButtonClick(event, '{{ user_id }}' )">Save Profile</button>
                <button class="cancel" id="cancel-edit-button" style="display:none;" onclick="onCancelButtonClick()">Cancel</button>
                <button class="change" id="open-change-password-modal">
                    <span class="change-b" id="change">Change Password</span>
                </button>
                <div id="modal" class="m">
                    <div class="m-content">
                        <span class="close">&times;</span>
                        <h3>Change Password</h3>
                        <form id="change-password-form" method="POST">
                            {% csrf_token %}
                            <label for="old_password-input">Old Password</label>
                            <input type="password" id="old_password-input" name="old_password" required>
                            
                            <label for="newpassword1-input">New Password</label>
                            <input type="password" id="password1-input" name="password1" required>
                            
                            <label for="newpassword2-input">Confirm new password</label>
                            <input type="password" id="password2-input" name="password2" required>
                        </form>
                        <button class="cancel" id="cancel-change-password-button">Go back</button>
                        <button class="change" id="change-password" onclick="getChangePassword()" data-user-id="{{ user_id }}">
                            <span class="change-b" id="change">Confirm</span>
                        </button>
                    </div>
                </div>
            {% elif is_friend %}
                {% if friendship_status %}
                    <form id="remove-friend-form" onsubmit="return friends_remove(event, '{{ user_id }}', '{{ user_view.id }}')">
                        {% csrf_token %}
                        <button class="friend-status" id="remove-friend-button">Remove Friend</button>
                    </form>
                {% else %}
                    {% if me %}
                        <button class="friend-status">Request Sent</button>
                    {% elif notification.status == 'Pending' %}
                        <button class="friend-status" id="decline-friend-button" onclick="handleNotificationProfile('{{ notification.id }}', 'decline', '{{ user_id }}', '{{ user_view.id }}', event)">Decline</button>
                        <button class="friend-status" id="accept-friend-button" onclick="handleNotificationProfile('{{ notification.id }}', 'accept', '{{ user_id }}', '{{ user_view.id }}', event)">Accept</button>                    
                    {% else %}
                        <form id="add-friend-form" onsubmit="return friends_add(event, '{{ user_id }}', '{{ user_view.id }}')">
                            {% csrf_token %}
                            <button id="add-friend-button" type="submit">Add Friend</button>
                        </form>
                    {% endif %}
                {% endif %}
            {% else %}
                <form id="add-friend-form" onsubmit="return friends_add(event, '{{ user_id }}', '{{ user_view.id }}')">
                    {% csrf_token %}
                    <button id="add-friend-button" type="submit">Add Friend</button>
                </form>
            {% endif %}
            
            <form id="edit-profile-form" method="POST" enctype="multipart/form-data" style="display:none;">
                {% csrf_token %}
                <label for="profile-picture-input">Profile Picture</label>
                <img id="profile-picture-preview" src="{{ user_view.picture.url }}" alt="Profile Picture Preview" style="display:none; width: 150px; height: 150px; object-fit: cover;">
                <input type="file" id="profile-picture-input" name="picture">
                
                <label for="username-input">Username</label>
                <input type="text" id="username-input" name="username" value="{{ user_view.username }}" required>
                
                <label for="description-input">Description</label>
                <textarea id="description-input" name="description" rows="4" cols="50">{{ user_view.description }}</textarea>
                
                <label for="email-input">Email</label>
                <input type="email" id="email-input" name="email" value="{{ user_view.email }}" required>
                
            </form>
            <div id="change-info2">
                <div class="text-block">
                    <span> {{ user_view.description }}</span>
                </div>
                    <h5 class="text-block"> Email {{ user_view.email }}</h5>
                    <h5 class="text-block"> Joined {{ user_view.created_at }}</h5>
            </div>
        </div>
        <div class="stats-history">
            <div class="stats">
                <div class="topic">
                    <img class="icon" src="{% static 'assets/icons/chart.png' %}" alt="chart">
                    <span class="icon-title3">Your Stats</span>
                </div>
                <div class="stats2">
                    <div class="percentages">
                        <div class="stats-head">
                            <div class="stat">
                                <h4 class="stats-title">WIN Rate</h4>
                                <h6 class="winr"> 100%</h6>
                            </div>
                            <div class="stat">
                                <h4 class="stats-title">WINS</h4>
                                <h6 class="winr"> 100%</h6>
                            </div>
                            <div class="stat">
                                <h4 class="stats-title">LOSSES</h4>
                                <h6 class="winr"> 100%</h6>
                            </div>
                            <div class="stat">
                                <h4 class="stats-title">GOALS SCORED</h4>
                                    <h6 class="winr"> 100%</h6>
                                </div>
                                <div class="stat">
                                    <h4 class="stats-title">GOALS SUFFERED</h4>
                                    <h6 class="winr"> 100%</h6>
                                </div>
                            </div>
                        </div>
                        <div class="graphs">
                            <div class="graph1">
                                <div class="numbers-stat">
                                    <h6>21312</h6>
                                    <h6>21312</h6>
                                </div>
                                <img class="graph-img" src="{% static 'assets/icons/graph.png' %}" alt="graph">
                            </div>
                            <div class="graph2">
                                <div class="numbers-stat">
                                    <h6>21312</h6>
                                    <h6>21312</h6>
                                </div>
                                <img class="graph-img" src="{% static 'assets/icons/graph.png' %}" alt="graph">
                            </div>
                            <div class="graph3">
                                <div class="numbers-stat">
                                    <h6>21312</h6>
                                    <h6>21312</h6>
                                </div>
                                <img class="graph-img" src="{% static 'assets/icons/graph.png' %}" alt="graph">
                            </div>
                            <div class="graph4">
                                <div class="numbers-stat">
                                    <h6>21312</h6>
                                    <h6>21312</h6>
                                </div>
                                <img class="graph-img" src="{% static 'assets/icons/graph.png' %}" alt="graph">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="stats">
                    <div class="topic">
                        <img class="icon" src="{% static 'assets/icons/history.png' %}" alt="chart">
                        <span class="icon-title3">Match History</span>
                    </div>
                    <div class="stats2">
                        <div id="match-container"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
