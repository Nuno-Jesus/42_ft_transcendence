{% extends 'base.html' %}
{% load static %}

{% block body %}
    <link rel="stylesheet" href="{% static 'css/navs.css' %}">
    <link rel="stylesheet" href="{% static 'css/top-bar.css' %}">
    <link rel="stylesheet" href="{% static 'css/side-menu.css' %}">
    <link rel="stylesheet" href="{% static 'css/friend-bar.css' %}">
    <link rel="stylesheet" href="{% static 'css/friend-block.css' %}">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'js/navs.js' %}"></script>
    <script src="{% static 'js/suggest_users.js' %}"></script>
    <script defer src="{% static 'js/friends.js' %}"></script>
    <script defer src="{% static 'js/friend-block.js' %}"></script>
    <script defer src="{% static 'js/description.js' %}"></script>
    
    <main id="MainPage" hx-boost="true">
        {% block main_content %}
        {% endblock %}
    </main>
    {% if user.is_authenticated %}
        {% block top-bar %}
        <div class="top-bar">
            <form method=POST action="{% url 'search-players' %}">
                {% csrf_token %}
                <div class="search-container">
                    <input type="text" placeholder="Search for players..." name="searched" id="search" onkeyup="getSuggestions()">
                    <button type="button" id="searchButton">
                        <img id="search-icon" src="{% static 'assets/icons/binoculars.png' %}">
                    </button>
                    <div id="suggestions" style="position: absolute; top: 100%; left: 0; width: 100%; border: 1px solid #ccc; background-color: #fff; z-index: 1000;"></div>
                </div>
            </form>
            <div class="top-right">
                <img class="bell-icon" src="{% static 'assets/icons/Doorbell.png' %}">
                <img class="profile-pic" src="{{ user.picture.url }}" alt="Profile">
            </div>
        </div>
        {% endblock %}
        
        {% block side-menu %}
            <div class="left-div" id="left-div">
                <button class="select-item expandable-section" onclick="toggleLeftDiv()">
                    <img class="icon2" src="{% static 'assets/icons/logo2.png' %}" alt="Ping Pong">
                    <span class="icon-title2 bold">Pong Game</span>
                </button>
                <div class="selects">
                    <a hx-get="{% url 'home' %}"
                       hx-trigger="click"
                       hx-target="#MainPage"
                       hx-swap="outerHTML">
                        <button class="select-item">
                            <img class="icon" src="{% static 'assets/icons/pingpong.png' %}" alt="Ping Pong">
                            <span class="icon-title">Singles</span>
                        </button>
                    </a>
                    <a hx-get="{% url 'tournaments' %}"
                       hx-trigger="click"
                       hx-target="#MainPage"
                       hx-swap="outerHTML">
                        <button class="select-item">
                            <img class="icon" src="{% static 'assets/icons/tournament.png' %}" alt="Tournament">
                            <span class="icon-title">Tournament</span>
                        </button>
                    </a>
                    <a hx-get="{% url 'profile' %}"
                       hx-trigger="click"
                       hx-target="#MainPage"
                       hx-swap="outerHTML">
                        <button class="select-item">
                            <img class="icon" src="{% static 'assets/icons/user.png' %}" alt="User">
                            <span class="icon-title">User</span>
                        </button>
                    </a>
                    <a hx-get="{% url 'login' %}"
                       hx-trigger="click"
                       hx-target="#main"
                       hx-swap="outerHTML"
                       class="logout-icon">
                        <button class="select-item">
                            <img class="icon" src="{% static 'assets/icons/logout.png' %}" alt="logout">
                            <span class="icon-title">Logout</span>
                        </button>
                    </a>
                </div>
            </div>
        {% endblock %}

        {% block friend-bar %}
            <button class="toggle-button" id="toggle-button" onclick="toggleSidebar()">
                <img src="{% static 'assets/icons/puxador.png' %}">
            </button>
            <div class="sidebar" id="sidebar">
                {% block friend-block %}
                    {% for friend in friends %}
                    {% if friend.user1_id.id == user_id %}
                    <a href="{% url 'user_profile' friend.user2_id.username %}">
                {% else %}
                    <a href="{% url 'user_profile' friend.user1_id.username %}">
                {% endif %}
                            <div class="friend-block" id="friend2" data-status="online">
                                {% if friend.user1_id.id == user_id %}
                                    <img class="profile-pic" src="{{ friend.user2_id.picture.url }}" alt="Profile">
                                    <div class="friend-info">
                                        <h4>{{ friend.user2_id.username }}</h4>
                                        <span class="status">{{ friend.user2_id.status }}</span>
                                    </div>
                                {% else %}
                                    <img class="profile-pic" src="{{ friend.user1_id.picture.url }}" alt="Profile">
                                    <div class="friend-info">
                                        <h4>{{ friend.user1_id.username }}</h4>
                                        <span class="status">{{ friend.user1_id.status }}</span>
                                    </div>
                                {% endif %}
                            </div>
                        </a>
                    {% endfor %}
                {% endblock %}
            </div>
        {% endblock %}
    {% endif %}
        

{% endblock %}